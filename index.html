<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arepita</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{
  margin:0;
  font-family:'Playfair Display', serif;
  background:linear-gradient(180deg,#0f2027,#203a43,#2c5364);
}

/* ===== HEADER ===== */
header{
  text-align:center;
  padding:1.2rem;
  color:#fff;
}
header h1{margin:0;font-size:2.5rem;}

/* ===== REPRODUCTOR ===== */
.player-wrapper{
  max-width:720px;
  margin:0 auto 0.5rem;
  position:relative;
}

.player{
  background:#fdf8f2;
  padding:0.6rem;
  border-radius:6px;
  display:flex;
  align-items:center;
  gap:0.6rem;
}

.player button{
  background:none;
  border:none;
  font-size:1.3rem;
  cursor:pointer;
}

.progress{flex:1;}

.more-btn{
  font-size:1.3rem;
}

/* LISTA DE CANCIONES */
.playlist{
  display:none;
  position:absolute;
  top:110%;
  right:0;
  background:#fdf8f2;
  width:100%;
  border-radius:6px;
  box-shadow:0 10px 20px rgba(0,0,0,.3);
  max-height:220px;
  overflow-y:auto;
  z-index:10;
}

.playlist div{
  padding:0.6rem;
  cursor:pointer;
  border-bottom:1px solid #ddd;
  font-size:0.85rem;
}
.playlist div:hover{
  background:#eee;
}

.song-name{
  text-align:center;
  font-size:0.85rem;
  color:#333;
  margin:0.3rem auto 1rem;
  max-width:720px;
}

/* ===== LIBRO ===== */
main{
  display:flex;
  justify-content:center;
  padding:1rem;
}

.page{
  display:none;
  background:#fdf8f2;
  max-width:720px;
  width:100%;
  padding:2rem;
  border-radius:6px;
  box-shadow:0 10px 25px rgba(0,0,0,.35);
  position:relative;
}

.page.active{display:block;}

.page h2{text-align:center;margin-top:0;}

.poem-content{
  height:420px;
  overflow-y:auto;
  line-height:1.8;
}

/* FAVORITO */
.favorite{
  position:absolute;
  top:18px;
  right:18px;
  font-size:1.5rem;
  cursor:pointer;
  color:#bbb;
}
.favorite.active{color:#c0392b;}

/* NAVEGACIÓN */
.page-number{text-align:center;margin-top:1rem;font-size:0.8rem;color:#777;}

.page-nav{text-align:center;margin-top:0.6rem;}
.page-nav button{
  border:1px solid #333;
  background:none;
  border-radius:50%;
  width:32px;
  height:32px;
  margin:0 4px;
  cursor:pointer;
}
</style>
</head>

<body>

<header>
  <h1>Arepita</h1>
</header>

<!-- REPRODUCTOR -->
<div class="player-wrapper">
  <div class="player">
    <button onclick="prevSong()"><i class="fa-solid fa-backward"></i></button>
    <button onclick="togglePlay()" id="playBtn"><i class="fa-regular fa-circle-play"></i></button>
    <button onclick="nextSong()"><i class="fa-solid fa-forward"></i></button>
    <button onclick="toggleShuffle()"><i class="fa-solid fa-shuffle"></i></button>
    <input type="range" class="progress">
    <button class="more-btn" onclick="togglePlaylist()">⋮</button>
  </div>

  <div class="playlist" id="playlist"></div>
</div>

<div class="song-name" id="songName">—</div>
<audio id="audio"></audio>

<main>
<!-- POEMAS (SIN CAMBIOS) -->
<!-- TODO TU CONTENIDO DE POEMAS SE MANTIENE IGUAL -->
</main>

<script>
/* ===== PÁGINAS ===== */
const pages=document.querySelectorAll('.page');
function showPage(n){
  pages.forEach(p=>p.classList.remove('active'));
  pages[n].classList.add('active');
}

/* ===== FAVORITOS ===== */
let favorites=JSON.parse(localStorage.getItem("favorites"))||[];
function toggleFavorite(i){
  const heart=document.querySelector(`.page[data-page="${i}"] .favorite`);
  if(favorites.includes(i)){
    favorites=favorites.filter(f=>f!==i);
    heart.classList.remove("active");
  }else{
    favorites.push(i);
    heart.classList.add("active");
  }
  localStorage.setItem("favorites",JSON.stringify(favorites));
}
favorites.forEach(i=>{
  const h=document.querySelector(`.page[data-page="${i}"] .favorite`);
  if(h)h.classList.add("active");
});

/* ===== MÚSICA ===== */
const songs=[
"Combustión - Jósean Log(MP3_160K).mp3",
"Diego Luna - Te Amo Y Más (Letra)(MP3_160K).mp3"
];

const audio=document.getElementById("audio");
const songName=document.getElementById("songName");
const playlist=document.getElementById("playlist");
const playBtn=document.getElementById("playBtn");

let index=0;
let shuffle=false;

function cleanName(n){
  return n.replace(/\(.*?\)|\.mp3|\.m4a/gi,"").trim();
}

songs.forEach((s,i)=>{
  const div=document.createElement("div");
  div.textContent=cleanName(s);
  div.onclick=()=>{index=i;loadSong();}
  playlist.appendChild(div);
});

function loadSong(){
  audio.src=songs[index];
  songName.textContent=cleanName(songs[index]);
  audio.play();
  playBtn.innerHTML='<i class="fa-solid fa-stop"></i>';
}

function togglePlay(){
  if(audio.paused){
    audio.play();
    playBtn.innerHTML='<i class="fa-solid fa-stop"></i>';
  }else{
    audio.pause();
    playBtn.innerHTML='<i class="fa-regular fa-circle-play"></i>';
  }
}

function nextSong(){
  if(shuffle){
    index=Math.floor(Math.random()*songs.length);
  }else{
    index=(index+1)%songs.length;
  }
  loadSong();
}

function prevSong(){
  index=(index-1+songs.length)%songs.length;
  loadSong();
}

function toggleShuffle(){
  shuffle=!shuffle;
}

function togglePlaylist(){
  playlist.style.display=playlist.style.display==="block"?"none":"block";
}

audio.addEventListener("ended",nextSong);

loadSong();
</script>

</body>
</html>
